setwd("C:/Users/Amit Kulkarni/Documents/R Programming/packages")
#install.packages(c("SDMTools", "pROC", "Hmisc"))
library(SDMTools)
library(pROC)
library(Hmisc)
library(ROCR)
setwd("C:/Users/Amit Kulkarni/Documents/R Programming/text analytics")
LRdata= read.csv("Dataset.csv", header=TRUE)
#View(LRdata)
deal.d = model.matrix(~deal -1, data=LRdata)
LRdata1 = data.frame(LRdata, deal.d)
#View(LRdata1)
#str(LRdata1)
set.seed(123)
split = sample.split(LRdata1$dealTRUE, SplitRatio = 0.80)
LRtrain= subset(LRdata1, split==T)
LRtest= subset(LRdata1, split==F)
View(LRtrain)
LRtrain=subset(LRtrain, select=-c(1,2,3,4,5,6,7,11:20))
LRtest=subset(LRtest, select=-c(1,2,3,4,5,6,7,11:20))

View(LRtrain)
View(LRtest)
#All Variables
LRModel = glm(dealTRUE ~ ., data=LRtrain, family= binomial) 
summary(LRModel)
predTest<-predict(LRModel, newdata=LRtest, type="response")
table(LRtest$dealTRUE, predTest>0.5)
(35+15)/nrow(na.omit(LRtest))
ROCRpred=prediction(predTest, LRtest$dealTRUE)
as.numeric(performance(ROCRpred,"auc")@y.values)
perf= performance(ROCRpred, "tpr","fpr")
plot(perf)