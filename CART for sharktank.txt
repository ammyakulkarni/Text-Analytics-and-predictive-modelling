setwd("C:/Users/Amit Kulkarni/Documents/R Programming/packages")
library(SDMTools)
library(pROC)
library(Hmisc)
library(caTools)
library(rpart)
library(rpart.plot)
library(rattle)
library(RColorBrewer)
library(scales)
library(data.table)
setwd("C:/Users/Amit Kulkarni/Documents/R Programming/text analytics")
CARTdata= read.csv("Dataset.csv", header=TRUE)
View(CARTdata)
deal.d = model.matrix(~deal -1, data=CARTdata)
CARTdata1 = data.frame(CARTdata, deal.d)
View(CARTdata1)
#str(CARTdata1)
set.seed(3000)
split = sample.split(CARTdata1$dealTRUE, SplitRatio = 0.80)
CARTtrain= subset(CARTdata1, split==T)
CARTtest= subset(CARTdata1, split==F)
CARTtrain=subset(CARTtrain, select=-c(1,2,3,4,5,6,7,11,17,18,20))

View(CARTtrain)
CARTtest=subset(CARTtest, select=-c(1,2,3,4,5,6,7,11,17,18,20))

#View(CARTtest)
#summary(CARTtrain)
r.ctrl=rpart.control(minsplit = 100, minbucket = 10, cp=0, xval=10)
CART_Train_Model = rpart(formula = dealTRUE~., data=CARTtrain , method="class", control = r.ctrl )
CART_Train_Model
prp(CART_Train_Model)
fancyRpartPlot(CART_Train_Model)
printcp(CART_Train_Model)
plotcp(CART_Train_Model)
CARTtrain$predict.class = predict(pruning_Tree, CARTtrain, type = "class")
CARTtrain$predict.score = predict(pruning_Tree, CARTtrain, type = "prob")
View(CARTtrain)